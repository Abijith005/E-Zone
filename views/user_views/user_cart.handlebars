<!DOCTYPE html>
<html lang="en" ng-app="wishlist">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Wishlist</title>
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@2.0.2/css/boxicons.min.css">
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">
	<link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,700" rel="stylesheet">

	<!-- Bootstrap -->
	<link type="text/css" rel="stylesheet" href="/css/bootstrap.min.css" />
	<!-- Slick -->
	<link type="text/css" rel="stylesheet" href="/css/slick.css" />
	<link type="text/css" rel="stylesheet" href="/css/slick-theme.css" />
	<!-- nouislider -->
	<link type="text/css" rel="stylesheet" href="/css/nouislider.min.css" />

	<!-- Font Awesome Icon -->
	<link rel="stylesheet" href="/css/font-awesome.min.css" />

	<!-- Custom stlylesheet -->
	<link type="text/css" rel="stylesheet" href="/css/style.css" />
	{{#unless cartDatas}}
	<link rel="stylesheet" href="/css/emptyCart.css">
	{{/unless}}

</head>

<body style="background-color: #F5F5F5;">

	{{!-- ****************************************************************************************************** --}}
	<!-- HEADER -->
	<header>
		<!-- TOP HEADER -->
		<div id="top-header">
			<div class="container">
				<ul class="header-links pull-left">
					<li><a href="#"><i class="fa fa-phone"></i> +021-95-51-84</a></li>
					<li><a href="#"><i class="fa fa-envelope-o"></i> email@email.com</a></li>
					<li><a href="#"><i class="fa fa-map-marker"></i> 1734 Stonecoal Road</a></li>
				</ul>
				<ul class="header-links pull-right">
					{{!-- <li><a href="#"><i class="fa fa-dollar"></i> USD</a></li>
					<li><a href="/user_login"><i class="fa fa-user-o"></i> Login</a></li> --}}
				</ul>
			</div>
		</div>
		<!-- /TOP HEADER -->

		<!-- MAIN HEADER -->
		<div id="header">
			<!-- container -->
			<div class="container">
				<!-- row -->
				<div class="row align-items-center">
					<!-- LOGO -->
					<div class="col-md-2">
						<div class="header-logo ">
							<a href="#" class="logo">
								<h1 class="font-weight-bold" style="color: #ffff;">E-<font color="#FFD523">Zone</font>

								</h1>
							</a>
						</div>
					</div>
					<!-- /LOGO -->

					<!-- SEARCH BAR -->
					<div class="col-md-8 text-center">
						<div class="header-search">
							<h1 class="text-white">Cart</h1>
						</div>
					</div>
					<div class="col-2 ms-auto">
						<div class="dropdown">
							<button class="btn btn-secondary text-white dropdown-toggle" type="button"
								id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
								aria-expanded="false">{{userName}}</button>
							<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
								<a class="dropdown-item" href="/user_profile">Profile</a>
								<a class="dropdown-item" href="/user_logout">Log Out</a>
							</div>
						</div>
					</div>

					<!-- /ACCOUNT -->
				</div>
				<!-- row -->
			</div>
			<!-- container -->
		</div>
		<!-- /MAIN HEADER -->
	</header>
	<!-- /HEADER -->
	{{!-- ****************************************************************************************************** --}}
	{{#if cartDatas}}
	<section class="pt-5 pb-5">
		<div class="container">
			<div class="row w-100">
				<div class="col-lg-12 col-md-12 col-12">
					<h3 class="display-5 mb-2">Shopping Cart</h3>
					<p class="mb-5">
						<i class="text-info font-weight-bold"></i> items in your cart
					</p>
					<table id="shoppingCart" class="table table-condensed table-responsive">
						<thead>
							<tr id="table">
								<th style="width:25%" class="text-center">Product</th>
								<th style="width:20%" class="text-center">Product Name</th>
								<th style="width:12%" class="text-center">Price</th>
								<th style="width:15%" class="text-center">Quantity</th>
								<th style="width:15%" class="text-center">Action</th>
								<th class="text-center"></th>

							</tr>
						</thead>
						<tbody>
							{{#each cartDatas}}
							<tr>
								<td data-th="Product" class="align-middle ">
									<div class="row justify-content-between">
										<div class="col-md-6 col-12 ">
											<img src="images/{{this.image.[0].filename}}" alt="" class="img-fluid  ">
										</div>

									</div>
								</td>
								<td class="align-middle text-center">
									<h5>{{this.product_name}}</h5>
								</td>
								<td class="align-middle text-center" data-th="Price"><b
										id="price{{this._id}}">{{this.price}}</b>
								</td>
								<td class="align-middle" data-th="Quantity">
									<div class="d-flex">
										<button onclick="changeQuantity('{{this._id}}','-1')"
											class="btn btn-primary mx-1">-</button>
										<input type="text" style="width:5rem;" min="1" max="10"
											id="quantityBox{{this._id}}"
											class="form-control form-control-lg text-center align-middle "
											value="{{this.quantity}}" readonly>
										<button onclick="changeQuantity('{{this._id}}','1')"
											class="btn btn-success mx-1 align-middle">+</button>
									</div>
								</td>
								{{!-- <td class="actions align-middle" data-th="">
									<div class="align-middle text-center">
										<a class="btn btn-white  bg-white btn-md mb-2"
											href="/deleteFromCart/{{this._id}}/{{this.quantity}}">
											<i class="fas fa-trash"></i><br>Remove
										</a>
									</div>
								</td> --}}

								<td class="text-center align-middle">
									<!-- Button trigger modal -->
									<button type="button" class="btn btn-danger btn-md mb-2" data-toggle="modal"
										data-target="#exampleModal{{this._id}}">
										<i class="fas fa-trash"></i>
									</button>

									<!-- Modal -->
									<div class="modal fade" id="exampleModal{{this._id}}" tabindex="-1" role="dialog"
										aria-labelledby="exampleModalLabel" aria-hidden="true">
										<div class="modal-dialog" role="document">
											<div class="modal-content">
												<div class="modal-header border-bottom-0 ">
													<h5 class="modal-title text-center text-dark"
														id="exampleModalLabel">Remove {{this.product_name}} From Cart ?.
													</h5>
													<button type="button" class="close" data-dismiss="modal"
														aria-label="Close">
														<span aria-hidden="true">&times;</span>
													</button>
												</div>
												{{!-- <div class="modal-body">
													...
												</div> --}}
												<div class="modal-footer">
													<button type="button" class="btn btn-secondary"
														data-dismiss="modal">Cancel</button>
													<a href="/deleteFromCart/{{this._id}}/{{this.quantity}}"
														type="button" class="btn btn-primary">Yes</a>
												</div>
											</div>
										</div>
									</div>
								</td>
								<td class="align-middle text-center text-danger" style="width: 30%;" data-th="Price">
									<p id="message{{this._id}}"></p>
								</td>
							</tr>
							{{/each}}
						</tbody>
					</table>
					<div class="float-right text-right">
						<h4>Subtotal:</h4>
						<h1 id="total">₹:{{cartDatas.totalAmount}}/-</h1>
					</div>
				</div>
			</div>
			<div class="row mt-4 d-flex align-items-center">
				<div class="col-sm-6 order-md-2 text-right">
					{{!-- {{#if Checkout}} --}}
					<a href="/checkOutPage" class="btn btn-warning mb-4 btn-lg pl-5 pr-5">Checkout</a>
					{{!-- {{/if}} --}}
				</div>
				<div class="col-sm-6 mb-3 mb-m-1 order-md-1 text-md-left">
					<a href="/">
						<i class="fas fa-arrow-left mr-2"></i> Continue Shopping</a>
				</div>
			</div>
		</div>
	</section>
	{{else}}
	<div class="container-fluid  mt-100">
		<div class="row">

			<div class="col-md-12">

				<div class="card">
					<div class="card-header">
					</div>
					<div class="card-body cart">
						<div class="col-sm-12 empty-cart-cls text-center">
							<img src="https://i.imgur.com/dCdflKN.png" width="130" height="130"
								class="img-fluid mb-4 mr-3">
							<h3><strong>Your Cart is Empty</strong></h3>
							<h4>Add Products To Your Cart :)</h4>
							<a href="/" class="btn btn-primary cart-btn-transform m-3" data-abc="true">continue
								shopping</a>


						</div>
					</div>
				</div>


			</div>

		</div>

	</div>
	{{/if}}

	<script src="/js/jquery.min.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<script src="/js/slick.min.js"></script>
	<script src="/js/nouislider.min.js"></script>
	<script src="/js/jquery.zoom.min.js"></script>
	<script src="/js/main.js"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<script>
		function changeQuantity(id, cond) {
			let quantity = parseInt(document.getElementById('quantityBox'+ id).value)
			axios.post('/changeQuantity', { id, quantity, cond, }).then((result) => {
				if (result.data.success) {
					let quantityBox = document.getElementById("quantityBox" + id);
					if (cond == 1) {
						quantityBox.value = Number(quantityBox.value) + 1;
						document.getElementById('message' + id).innerHTML = ''
						document.getElementById('total').innerHTML = `₹:${result.data.totalAmount}/-`
					} else {
						quantityBox.value = Number(quantityBox.value) - 1;
						document.getElementById('message' + id).innerHTML = ''
						document.getElementById('total').innerHTML = `₹:${result.data.totalAmount}/-`
					}
				} else {
					document.getElementById('message' + id).innerHTML = result.data.message				
				}
			})
		}
	</script>
</body>

</html>